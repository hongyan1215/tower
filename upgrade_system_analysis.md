# 塔防遊戲升級系統分析

## 升級機制概述

### 基本升級規則
- **等級範圍**: 1級（初始）到最高等級（大部分塔3級，機槍塔4級）
- **升級條件**: 需要足夠金錢支付升級費用
- **升級效果**: 每次升級提升傷害、射程、射速

### 升級數值計算

#### 傷害提升
```
新傷害 = 基礎傷害 × [1 + (等級-1) × 0.5]
```
- 1級: 100% 基礎傷害
- 2級: 150% 基礎傷害 (+50%)
- 3級: 200% 基礎傷害 (+100%)
- 4級: 250% 基礎傷害 (+150%) [僅機槍塔]

#### 射程提升
```
新射程 = 基礎射程 × [1 + (等級-1) × 0.2]
```
- 1級: 100% 基礎射程
- 2級: 120% 基礎射程 (+20%)
- 3級: 140% 基礎射程 (+40%)
- 4級: 160% 基礎射程 (+60%) [僅機槍塔]

⚠️ **例外**: 毒氣塔射程不隨等級增加（保持100%基礎射程）

#### 射速提升（攻擊間隔縮短）
```
新射速 = 基礎射速 ÷ [1 + (等級-1) × 0.3]
```
- 1級: 100% 基礎射速
- 2級: 77% 射擊間隔 (+30% 射速)
- 3級: 59% 射擊間隔 (+69% 射速)
- 4級: 48% 射擊間隔 (+108% 射速) [僅機槍塔]

### 升級費用系統
- **初始升級費用**: 每種塔都有固定的基礎升級費用
- **費用遞增**: 每次升級後，下次升級費用 × 1.5
- **總投資追蹤**: 系統記錄塔的總投資成本（建造+所有升級）

## 各塔升級費用詳情

### 機槍塔 (4級上限)
- 建造: 80金
- 1→2級: 120金
- 2→3級: 180金 (120×1.5)
- 3→4級: 270金 (180×1.5)
- **總投資**: 650金

### 狙擊塔 (3級上限)
- 建造: 200金
- 1→2級: 300金
- 2→3級: 450金 (300×1.5)
- **總投資**: 950金

### 加農砲 (3級上限)
- 建造: 180金
- 1→2級: 270金
- 2→3級: 405金 (270×1.5)
- **總投資**: 855金

### 冰凍塔 (3級上限)
- 建造: 100金
- 1→2級: 150金
- 2→3級: 225金 (150×1.5)
- **總投資**: 475金

### 連鎖塔 (3級上限)
- 建造: 220金
- 1→2級: 330金
- 2→3級: 495金 (330×1.5)
- **總投資**: 1045金

### 毒氣塔 (3級上限)
- 建造: 140金
- 1→2級: 210金
- 2→3級: 315金 (210×1.5)
- **總投資**: 665金

### 多管塔 (3級上限)
- 建造: 250金
- 1→2級: 375金
- 2→3級: 562金 (375×1.5)
- **總投資**: 1187金

### 詛咒塔 (3級上限)
- 建造: 150金
- 1→2級: 225金
- 2→3級: 337金 (225×1.5)
- **總投資**: 712金

### 金錢塔 (3級上限) - 戰術經濟系統
- 建造: 150金
- 1→2級: 225金
- 2→3級: 337金 (225×1.5)
- **總投資**: 712金

### 治療塔 (3級上限) - 大幅削弱
- 建造: 160金
- 1→2級: 240金
- 2→3級: 360金 (240×1.5)
- **總投資**: 760金

## 升級策略建議

### 高性價比升級
1. **冰凍塔**: 總投資最低(475金)，控制效果顯著
2. **機槍塔**: 4級上限，後期DPS極高
3. **狙擊塔**: 強化後成為頂級單體DPS塔，投資回報高
4. **毒氣塔**: 中等投資，AoE傷害對群體敵人有效
5. **治療塔**: 高投資(760金)，高傷害低頻率+治療

### 高投資高回報
1. **多管塔**: 投資最高(1187金)但多目標攻擊
2. **連鎖塔**: 投資高(1045金)連鎖傷害在敵人密集時非常有效
3. **狙擊塔**: 投資高(950金)超高單體傷害，現在是頂級DPS塔

### 戰術經濟塔
1. **金錢塔**: 中等投資(712金)，戰術性經濟回報

### 特殊定位塔
1. **治療塔**: 投資高(760金)，高傷害低頻率，附帶治療功能

### 升級優先順序建議
1. **早期**: 優先升級機槍塔和冰凍塔（性價比高）
2. **中期**: 根據敵人類型選擇升級特化塔
3. **後期**: 全面升級核心塔陣容

## 特殊升級效果

### 基礎升級效果（所有等級）
- **加農砲**: 濺射範圍隨等級增加 (85 + 等級×25)
- **連鎖塔**: 連鎖範圍和次數隨等級增加
- **詛咒塔**: 易傷效果強度隨等級增加
- **冰凍塔**: 減速效果和持續時間隨等級增加

### 🌟 3級專屬強化效果

#### 機槍塔 (3級) - 重新平衡
- **精準射擊**: 25%機率造成雙倍傷害
- **效果**: 平均DPS提升25%，增加爆發潛力但不過強

#### 狙擊塔 (3級) - 強化平衡  
- **基礎強化**: 傷害320，射程280，攻擊間隔2.2秒
- **致命一擊**: 對血量低於30%的敵人造成額外80%傷害
- **效果**: 高DPS單體輸出，專精收割殘血敵人，現在有競爭力

#### 加農砲 (3級) - 重新平衡
- **強化爆炸**: 濺射範圍+30%，濺射傷害從70%提升到90%
- **效果**: 更好的群體清理能力，傷害衰減減少

#### 冰凍塔 (3級) - 重新平衡
- **深度冰凍**: 15%機率完全凍結敵人1秒，減速效果增強
- **效果**: 增加控制能力，但依賴機率不會過強

#### 連鎖塔 (3級)
- **增強連鎖**: 連鎖次數+1，連鎖範圍+20像素
- **效果**: 最多可連鎖5個目標，連鎖範圍140像素

#### 毒氣塔 (3級) - 重新平衡 ⚠️
- **腐蝕毒素**: 降低敵人護甲20%，造成持續傷害
- **效果**: 每0.5秒造成10%毒傷害，持續4秒，降低護甲
- **特殊**: 射程不隨等級增加（避免AoE攻擊過強）

#### 多管塔 (3級) - 重新平衡
- **追蹤彈藥**: 子彈輕微追蹤目標，傷害+20%
- **效果**: 提高命中率和傷害，但不會過度強化

#### 詛咒塔 (3級)
- **增強詛咒**: 易傷效果提升至1.9倍，持續8秒
- **效果**: 被詛咒敵人受到的所有傷害+90%

#### 金錢塔 (3級) - 戰術經濟系統
- **智能收益**: 根據戰況動態調整金錢生成
- **基礎收益**: 每6秒產生 3 + 等級 金錢
- **戰術獎勵**: 擊殺獎勵、波次獎勵、危機獎勵、投資回報
- **3級特殊**: 投資回報 + 黃金時代雙倍獎勵機率
- **特殊**: 無攻擊能力，戰術經濟建築，收益與戰況掛鉤

#### 治療塔 (3級) - 神聖祝福
- **高攻擊低頻率**: 攻擊力較高但攻擊頻率很低
- **全局治療冷卻**: 每4秒嘗試治療，但全局2秒冷卻防止疊加
- **3級特殊**: 神聖祝福 - 25%機率額外+2HP並給予5秒50%傷害減免
- **特殊**: 攻擊和治療獨立，3級有強力防護效果

## 升級價值重新評估

### 重新平衡後的3級升級
- **適度增強**: 3級效果有價值但不會過度強化
- **戰術選擇**: 每種塔的3級效果都有特定用途和時機
- **平衡投資**: 3級升級與建造新塔之間有合理的選擇權衡

### 平衡後的升級策略
1. **優先2級**: 依然是最佳性價比選擇
2. **戰術性3級**: 根據敵人類型和戰場情況選擇升級
3. **專精化**: 選擇1-2座關鍵塔升到3級，而非全面升級

### 各塔3級升級建議時機
- **機槍塔**: 面對大量低血量敵人時
- **狙擊塔**: 對付高血量單體敵人時  
- **加農砲**: 敵人經常聚集成群時
- **冰凍塔**: 需要更強控制效果時
- **毒氣塔**: 對付重裝敵人時（降護甲），但射程不會增加
- **多管塔**: 面對快速移動敵人時
- **連鎖塔**: 敵人密度高時
- **詛咒塔**: 配合其他高傷害塔時
- **金錢塔**: 極長期遊戲，需要機率性經濟爆發時
- **治療塔**: 生命值經常受威脅，需要強力防護效果時

## 特殊平衡機制

### 毒氣塔射程限制
毒氣塔是唯一射程不隨等級增加的塔：
- **原因**: 毒氣塔能同時攻擊範圍內所有敵人，射程增加會讓它過於強大
- **平衡**: 通過限制射程來平衡其強大的AoE能力
- **策略**: 需要更仔細的位置規劃，但3級腐蝕效果仍然值得投資

### 升級投資建議
1. **毒氣塔**: 優先升級傷害和射速，射程保持不變
2. **金錢塔**: 優先升級以提高金錢生成效率
3. **治療塔**: 平衡攻擊力和治療效果的提升
4. **其他攻擊塔**: 全面提升傷害、射程、射速
5. **戰術考量**: 毒氣塔需要更靠近敵人路徑放置

## 新塔類型升級分析

### 💰 金錢塔升級效果 - 戰術經濟系統
- **基礎收益**: 
  - 1級: 每6秒4金 (基礎3 + 1級)
  - 2級: 每6秒5金 (基礎3 + 2級)
  - 3級: 每6秒6金 (基礎3 + 3級)
- **戰術獎勵系統**:
  - 擊殺獎勵: 8 + 等級×2 金 (敵人死亡後3秒內)
  - 波次獎勵: 15 + 波次×3 金 (波次完成時)
  - 危機獎勵: 10 + 等級×3 金 (生命值≤30時)
  - 投資回報: 其他塔數量×0.5 金 (3級特有)
- **3級特殊**: 20%機率所有獎勵翻倍
- **實際收益**: 根據戰況可達每6秒20-50金
- **戰略價值**: 戰術性經濟塔，收益與玩家表現掛鉤

### 💚 治療塔升級效果 - 神聖祝福特效
- **1級**: 25攻擊力 + 1HP治療（受全局冷卻限制）
- **2級**: 37攻擊力 + 2HP治療（受全局冷卻限制）
- **3級**: 50攻擊力 + 3HP治療 + 神聖祝福特效
- **3級特殊**: 25%機率額外+2HP並給予5秒50%傷害減免
- **攻擊頻率**: 每6秒攻擊一次（頻率很低）
- **治療機制**: 每4秒嘗試治療，但全局2秒冷卻防止疊加
- **防護效果**: 3級提供強力的臨時傷害減免
- **戰略價值**: 高傷害低頻率攻擊塔，附帶強力防護效果

### 新塔升級策略 - 戰術經濟機制
1. **金錢塔**: 推薦給積極型玩家，戰術性經濟回報與表現掛鉤
2. **治療塔**: 雙重功能塔，攻擊和治療獨立但受全局冷卻限制
3. **治療塔數量限制**: 多個治療塔不會疊加治療效果
4. **升級價值**: 提升單塔的攻擊力和治療量，比建造多塔更有效
5. **使用場景**: 適合長期防守位置，1-2座即可提供最大治療效果
6. **戰略考量**: 避免建造過多治療塔，專注於升級和攻擊塔配合

## 🚫 治療塔全局冷卻機制

### 防永生設計
- **全局冷卻**: 所有治療塔共享2秒治療冷卻
- **防疊加**: 多個治療塔不會同時治療
- **優先級**: 最先嘗試治療的塔會觸發全局冷卻
- **平衡目的**: 防止多塔疊加導致玩家永生

### 治療效能計算
- **理論最大**: 每2秒最多1次治療（受全局冷卻限制）
- **1級塔**: 最多1HP/2秒 = 30HP/分鐘
- **2級塔**: 最多2HP/2秒 = 60HP/分鐘  
- **3級塔**: 最多3HP/2秒 = 90HP/分鐘
- **多塔現實**: 建造多塔不會增加治療頻率

### 建造建議
- **推薦數量**: 1-2座治療塔即可
- **升級優先**: 升級比建造新塔更有效
- **配置策略**: 專注於攻擊塔+少量治療塔的組合

## 🌟 新塔3級特殊效果詳解

### 💰 金錢塔 - 戰術經濟系統
- **基礎機制**: 根據戰況提供不同獎勵
- **擊殺獎勵**: 敵人死亡後3秒內提供額外收益
- **波次獎勵**: 每波完成時提供大額獎勵
- **危機獎勵**: 生命值低時提供緊急資金
- **投資回報**: 3級時每座其他塔提供持續收益
- **黃金時代**: 20%機率所有獎勵翻倍
- **戰略價值**: 收益與玩家表現掛鉤，鼓勵積極遊戲
- **建議**: 適合積極進攻型玩家，收益可觀且有戰術意義

### 💚 治療塔 - 神聖祝福
- **觸發機率**: 25%
- **治療效果**: 額外+2HP (3HP → 5HP)
- **防護效果**: 5秒內受到傷害減少50%
- **視覺效果**: 金黃色神聖光芒
- **戰略價值**: 提供強力的臨時無敵效果
- **建議**: 在高難度波次中非常有價值

### 🎯 3級升級價值重評估
- **金錢塔**: 3級特效略微提升實用性，但仍不推薦
- **治療塔**: 3級特效大幅提升生存能力，升級價值很高
- **投資建議**: 治療塔3級值得投資，金錢塔3級仍需謹慎考慮

## 📊 DPS與性價比分析 (當前數值)

### 基礎塔 DPS 計算
基於當前遊戲數值 (傷害 ÷ 攻擊間隔 × 1000 = DPS)

| 塔類型 | 傷害 | 攻擊間隔(ms) | DPS | 建造成本 | DPS/Cost | 總投資 | DPS/總投資 |
|--------|------|-------------|-----|----------|----------|--------|------------|
| **機槍塔** | 12 | 200 | **60.0** | 80 | **0.75** | 650 | **0.092** |
| **狙擊塔** | 320 | 1800 | **177.8** | 200 | **0.89** | 950 | **0.187** |
| **加農砲** | 100 | 1400 | **71.4** | 180 | **0.40** | 855 | **0.084** |
| **冰凍塔** | 25 | 700 | **35.7** | 100 | **0.36** | 475 | **0.075** |
| **連鎖塔** | 70 | 900 | **77.8** | 220 | **0.35** | 1045 | **0.074** |
| **毒氣塔** | 35 | 1100 | **31.8** | 140 | **0.23** | 665 | **0.048** |
| **多管塔** | 55 | 800 | **68.8** | 250 | **0.28** | 1187 | **0.058** |
| **詛咒塔** | 45 | 900 | **50.0** | 150 | **0.33** | 712 | **0.070** |
| **治療塔** | 25 | 6000 | **4.2** | 160 | **0.026** | 760 | **0.0055** |

### 3級滿級 DPS 計算
基於升級公式：傷害×2.0，攻擊間隔×0.59 (約69%射速提升)

| 塔類型 | 3級傷害 | 3級間隔(ms) | 3級DPS | 3級DPS/總投資 | 特殊效果加成 |
|--------|---------|-------------|--------|---------------|-------------|
| **機槍塔** | 24 | 118 | **203.4** | **0.313** | +25%爆擊 = **254.3** |
| **狙擊塔** | 640 | 1062 | **602.6** | **0.634** | 殘血+80% = **1084.7** |
| **加農砲** | 200 | 826 | **242.1** | **0.283** | 濺射90% |
| **冰凍塔** | 50 | 413 | **121.1** | **0.255** | 15%凍結 |
| **連鎖塔** | 140 | 531 | **263.7** | **0.252** | +1連鎖目標 |
| **毒氣塔** | 70 | 649 | **107.9** | **0.162** | 護甲-20%+DoT |
| **多管塔** | 110 | 472 | **233.1** | **0.196** | 追蹤+20%傷害 |
| **詛咒塔** | 90 | 531 | **169.5** | **0.238** | 易傷1.9倍 |
| **治療塔** | 50 | 3540 | **14.1** | **0.019** | 25%神聖祝福 |

### 機槍塔 4級特殊計算
機槍塔可升到4級：傷害×2.5，攻擊間隔×0.48

| 等級 | 傷害 | 間隔(ms) | DPS | 特殊效果 | 實際DPS |
|------|------|---------|-----|----------|---------|
| **4級** | 30 | 96 | **312.5** | +25%爆擊 | **390.6** |

### 🏆 DPS 排行榜

#### 基礎建造性價比 (DPS/Cost)
1. **狙擊塔**: 0.89 (攻速提升後最高性價比)
2. **機槍塔**: 0.75 (依然優秀)
3. **加農砲**: 0.40 (AoE補償)
4. **冰凍塔**: 0.36 (控制型)
5. **詛咒塔**: 0.33 (輔助型)

#### 滿級投資回報 (DPS/總投資)
1. **狙擊塔**: 0.634 (攻速提升後最佳長期投資)
2. **機槍塔**: 0.313 (4級後)
3. **加農砲**: 0.283 (AoE傷害)
4. **冰凍塔**: 0.255 (控制+傷害)
5. **連鎖塔**: 0.252 (多目標)

#### 絕對DPS排行 (3級滿級)
1. **狙擊塔**: 602.6 DPS (殘血時1084.7)
2. **連鎖塔**: 263.7 DPS (多目標)
3. **加農砲**: 242.1 DPS (AoE)
4. **多管塔**: 233.1 DPS (多目標)
5. **機槍塔**: 203.4 DPS (爆擊時254.3)

### 💡 戰術建議

#### 早期建造 (性價比優先)
1. **狙擊塔** - 攻速提升後最高DPS/Cost比值
2. **機槍塔** - 依然優秀的性價比
3. **冰凍塔** - 便宜的控制+傷害

#### 中後期投資 (絕對DPS優先)
1. **狙擊塔升級** - 最高單體DPS，投資回報最佳
2. **機槍塔升4級** - 持續高DPS輸出
3. **連鎖塔** - 多目標高傷害

#### 特殊用途塔
- **加農砲**: AoE清群，濺射傷害
- **毒氣塔**: 降護甲+DoT，但DPS較低
- **詛咒塔**: 輔助其他塔，易傷效果強力
- **多管塔**: 多目標，追蹤彈藥
- **治療塔**: 生存輔助，DPS極低但有治療價值

### 🎯 平衡狀況評估

#### 狙擊塔強化效果
- **攻速提升**: 2200ms → 1800ms (-18%攻擊間隔)
- **DPS提升**: 145.5 → **177.8** (+22%)
- **性價比**: 從0.73提升到**0.89** (超越機槍塔)
- **評估**: 攻速提升解決漏怪問題，現在是最強單體DPS塔

#### 整體平衡
- **狙擊塔**: 攻速提升後成為新的性價比之王和最佳長期投資
- **機槍塔**: 依然優秀，4級後絕對DPS強勁
- **其他塔**: 各有特色，平衡合理
- **新塔**: 金錢塔和治療塔定位明確，不影響戰鬥平衡

## ⚠️ 重要平衡提醒

### 新塔現狀
- **金錢塔**: 已削弱至幾乎無用的程度，DPS為0
- **治療塔**: 重新定位為高傷害低頻率攻擊塔，附帶治療功能，DPS極低
- **設計目的**: 避免破壞原有遊戲平衡
- **玩家建議**: 金錢塔避免使用，治療塔可作為特殊攻擊塔考慮